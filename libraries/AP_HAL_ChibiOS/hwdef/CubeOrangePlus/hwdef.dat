# hw definition file for processing by chibios_hwdef.py

# MCU class and specific type
MCU STM32H7xx STM32H757xx

define CORE_CM7
define SMPS_PWR

include ../CubeOrange/hwdef.inc

undef USB_STRING_PRODUCT
undef USB_STRING_MANUFACTURER
undef APJ_BOARD_ID
undef USB_PRODUCT

# USB setup
USB_PRODUCT 0x1058
USB_STRING_MANUFACTURER "CubePilot"
USB_STRING_PRODUCT "CubeOrange+"

# Unused chip select for ICM45686
PG1 ICM45686_CS CS SPEED_VERYLOW

SPIDEV icm42688_ext2  SPI4 DEVID4  GYRO_EXT_CS   MODE3  2*MHZ  8*MHZ

APJ_BOARD_ID 1063

undef CHECK_ICM42688_EXT
undef CHECK_IMU0_PRESENT
undef CHECK_IMU1_PRESENT
undef IMU

SPIDEV icm42688_ext   SPI4 DEVID4  ACCEL_EXT_CS  MODE3  2*MHZ  8*MHZ

IMU Invensensev3 SPI:icm42688_ext ROTATION_YAW_90
IMU Invensensev3 SPI:icm42688_ext2 ROTATION_PITCH_180_YAW_90
IMU Invensensev2 SPI:icm20948_ext ROTATION_PITCH_180
IMU Invensensev2 SPI:icm20948 ROTATION_YAW_270

CHECK_ICM42688_EXT2     spi_check_register("icm42688_ext2", INV3REG_WHOAMI, INV3_WHOAMI_ICM42688)
CHECK_ICM42688_EXT      spi_check_register("icm42688_ext", INV3REG_WHOAMI, INV3_WHOAMI_ICM42688)

CHECK_IMU0_PRESENT   $CHECK_ICM42688_EXT
CHECK_IMU1_PRESENT   $CHECK_ICM20948_EXT || $CHECK_ICM42688_EXT2
